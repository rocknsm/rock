filter {
  if [@metadata][stage] == "fsf" {
    if ![tags] {      
        mutate { remove_field => ["path"] }
    }
  }
  else {
      mutate { add_field => { "[@meta][stage]" => "_parsefailure" } }
  }
}

