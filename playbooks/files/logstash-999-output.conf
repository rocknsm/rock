output {
    if [@metadata][stage] == "broraw_kafka" {
        kafka {
        codec => json
        topic_id => "bro-clean"
        bootstrap_servers => "127.0.0.1:9092"
        }

        elasticsearch {
            hosts => ["127.0.0.1"]
            index => "bro-%{+YYYY.MM.dd}"
            document_type => "%{[@meta][event_type]}"
            manage_template => false
        }
    }
    else if [@metadata][stage] == "suricata_eve" {
        #stdout { codec => rubydebug }
        elasticsearch {
            hosts => ["127.0.0.1"]
            index => "suricata-%{+YYYY.MM.dd}"
            document_type => "%{event_type}"
        }
    }
    else if [@metadata][stage] == "fsf" {
        #stdout { codec => rubydebug }
        elasticsearch {
            hosts => ["127.0.0.1"]
            index => "fsf-%{+YYYY.MM.dd}"
            document_type => "fsf"
        }
    }
    else if "[@meta][stage]" == "_parsefailure" {
        elasticsearch {
            hosts => ["127.0.0.1"]
            index => "parse-failures-%{+YYYY.MM.dd}"
            document_type => "_parsefailure"
        }
    }
}
